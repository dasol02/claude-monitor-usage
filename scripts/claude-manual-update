#!/bin/bash
# Chrome Extensionì´ ì‘ë™í•˜ì§€ ì•Šì„ ë•Œ ìˆ˜ë™ìœ¼ë¡œ ì‚¬ìš©ëŸ‰ ì…ë ¥
# ì‚¬ìš©ë²•: claude-manual-update 10 10  (session% weekly%)

if [ -z "$1" ] || [ -z "$2" ]; then
    echo "âŒ Usage: claude-manual-update <session%> <weekly%>"
    echo ""
    echo "Example:"
    echo "  claude-manual-update 10 10"
    echo "  claude-manual-update 15 20"
    exit 1
fi

SESSION=$1
WEEKLY=$2

echo "ğŸ“Š Manual Update"
echo "   Session: ${SESSION}%"
echo "   Weekly: ${WEEKLY}%"
echo ""

# JSON íŒŒì¼ ìƒì„±
cat > /tmp/claude-web-usage.json << EOF
{
  "timestamp": "$(date -u +"%Y-%m-%dT%H:%M:%SZ")",
  "source": "manual_input",
  "session": {
    "percentage": ${SESSION},
    "last_updated": "$(date -u +"%Y-%m-%dT%H:%M:%SZ")"
  },
  "weekly": {
    "percentage": ${WEEKLY},
    "last_updated": "$(date -u +"%Y-%m-%dT%H:%M:%SZ")"
  }
}
EOF

# SwiftBar ìƒˆë¡œê³ ì¹¨
open "swiftbar://refreshallplugins" 2>/dev/null
touch "$HOME/Library/Application Support/SwiftBar/ClaudeUsage.1m.sh" 2>/dev/null

echo "âœ… SwiftBar updated to ${SESSION}%"
echo ""
echo "ğŸ” Verify:"
echo "  cat /tmp/claude-web-usage.json"
